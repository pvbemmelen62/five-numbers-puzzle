
<html>
  <head>
    <script src="Permutations.js"></script>
    <script src="NumberSystem.js"></script>
  <head>
  <body>
    <div id="debugout">
    </div>

    <button onclick="doIt();" >calculate solutions</button>

<script type="text/javascript">
  // [JSDG5] JavaScript: The Definitive Guide, Fifth Edition; by David Flanagan.

  function debug(s) {
    var out = document.getElementById("debugout");
    out.innerHTML += "<br />" + s;
  }
  function assert(condition, message) {
    if(!condition) {
      debug("assert failed: " + message);
      throw new Error("assert failed: " + message);
    }
  }

  /*--------------------------------------------------------------------------

  exprFuncs[0] = (fs,ns) => fs[3](fs[2](fs[1](fs[0](ns[0],ns[1]),ns[2]),ns[3]),ns[4]);

    each leaf node holds a number
    each internal nodes holds a binary operators

          3
         / \
        2   4
       / \
      1   3
     / \
    0   2
   / \
  0   1

  --------------------------------------------------------------------------*/

  let opFuncs = [];
  opFuncs[0] = (x,y) => x+y;
  opFuncs[1] = (x,y) => x-y;
  opFuncs[2] = (x,y) => x*y;
  opFuncs[3] = (x,y) => x/y;

  let exprFuncs = [];
  exprFuncs[0] = (fs,ns) => fs[3](fs[2](fs[1](fs[0](ns[0],ns[1]),ns[2]),ns[3]),ns[4]);
  exprFuncs[1] = (fs,ns) => fs[3](fs[2](fs[0](ns[0],ns[1]),fs[1](ns[2],ns[3])),ns[4]);
  exprFuncs[2] = (fs,ns) => fs[3](fs[1](fs[0](ns[0],ns[1]),ns[2]),fs[2](ns[3],ns[4]));

  function closeEnough(x,y) {
    let rv = Math.abs(x-y) < 0.001;
    return rv;
  }

  function doIt() {
    var numbers = [13,21,23,25,27];
    var numPerms = new Permutations(numbers);
    var count = 0;
    while(numPerms.hasNext()) {
      // TMP
      if(count == 10) {
        break;
      }
      let numPerm = numPerms.next();
      let opsIter = new NumberSystem([4,4,4,4]);
      while(opsIter.hasNext()) {
        ++count;
        let ops = opsIter.next();
        let funcs = ops.map(i => opFuncs[i]);

        for(let i=0; i<exprFuncs.length; ++i) {
          let exprFunc = exprFuncs[i];
          let val = exprFunc(funcs,numPerm);
          if(closeEnough(val, 15)) {
            debug("i:" + i + ", count:" + count + ", val:" + val + ", numPerm:" + numPerm + ", ops:" + ops);
          }
        }
      }
    }
    debug("count: " + count);
  }
  

</script>
  </body>
</html>
